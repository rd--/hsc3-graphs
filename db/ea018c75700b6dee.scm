; https://twitter.com/redFrik/status/1136928201886904320 (f0)
(let ((f (lambda (a i)
           (let* ((b (make-mce (list 4 2 1 3 5)))
                  (c (Round (Mul (a ar (FDiv 1 b) 0) b) (GT (a ar (FDiv b 9) 0) 0)))
                  (o (SinOscFB ar (Mul (Pow c 2) (Add (GT (a ar 0.02 i) 0) (Mul 1 50))) (Mod (a ar (FDiv c 9) 0) 1)))
                  (s (Mul (Mul o (Max (a ar (Mul (FDiv 1 b) (a ar (FDiv b 99) i)) 0) 0)) (a ar 0.01 i)))
                  (x (AllpassC s 1 (Wrap c 0.5 1) 2))
                  (y (Mul (BPF x (Add (Mul i 99) 400) 0.001) (Add (a ar 0.04 i) (Mul 1 9)))))
             (FDiv (splay (Add x y) 1 1 0 #t) 3)))))
  (FDiv (mix (make-mce (zip-with f (list LFTri LFSaw LFPar) (list 0 1 2)))) 3))
